/* === GERAL === */
* { margin: 0; padding: 0; box-sizing: border-box; user-select: none; }
body {
    font-family: 'Segoe UI', sans-serif;
    background: #111; color: #eee;
    height: 100vh; overflow: hidden;
}

/* === LAYOUT PRINCIPAL === */
#main-layout {
    display: flex; width: 100%; height: 100%;
    align-items: center; justify-content: center;
}
#game-wrapper { position: relative; }

/* === CONTAINER DO JOGO === */
#game-container {
    width: 1100px; height: 650px;
    background: #222; border: 3px solid #444;
    overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,0.9);
    position: relative;
}

#world { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 1; }
#damage-layer { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 50; pointer-events: none; }

/* Countdown Overlay */
#countdown-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.5); z-index: 100;
    display: none; align-items: center; justify-content: center;
    font-size: 120px; font-weight: bold; color: #FFF;
    text-shadow: 0 0 20px #000; pointer-events: none;
}

/* === BARRA LATERAL (SIDEBAR UI) === */
#sidebar {
    width: 250px; height: 650px; background: #1a1a1a;
    border: 3px solid #444; border-left: none; padding: 20px;
    display: flex; flex-direction: column; gap: 20px;
}
#sidebar h2 { font-size: 20px; color: #4CAF50; text-align: center; margin-bottom: 10px; }
.stat-group { display: flex; flex-direction: column; gap: 5px; }
.stat-label { font-weight: bold; font-size: 14px; display: flex; justify-content: space-between; }
.stat-box { background: #333; padding: 10px; border-radius: 5px; font-size: 14px; line-height: 1.6; border: 1px solid #444; }
#weapon-display { color: #00FFFF; font-weight: bold; text-shadow: 0 0 5px rgba(0,255,255,0.3); }
.bar-container { width: 100%; height: 15px; background: #000; border-radius: 4px; overflow: hidden; border: 1px solid #555; }
.bar-fill { height: 100%; width: 0%; transition: width 0.2s; }
.xp-fill { background: #FFC107; } .health-fill { background: #F44336; }

/* === TELAS (OVERLAYS) === */
.screen-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    background: rgba(0,0,0,0.95); z-index: 200; backdrop-filter: blur(5px);
}
.selection-grid { display: flex; gap: 20px; margin-top: 20px; flex-wrap: wrap; justify-content: center; }
.class-card, .weapon-card, .upgrade-option {
    background: #333; border: 2px solid #555; border-radius: 8px; padding: 15px; width: 180px; height: 160px;
    display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; cursor: pointer; transition: 0.2s;
}
.class-card:hover, .weapon-card:hover, .upgrade-option:hover { background: #444; border-color: #FFD700; transform: translateY(-5px); }
button {
    padding: 12px 30px; font-size: 18px; font-weight: bold; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px; transition: 0.2s;
}
button:hover { background: #45a049; transform: scale(1.05); }

/* === BOSS HUD === */
#boss-hud { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); width: 500px; z-index: 150; text-align: center; }
#boss-name { color: #FFD700; font-weight: bold; text-shadow: 0 0 5px black; }
.boss-bar-container { width: 100%; height: 15px; background: #222; border: 2px solid #FFD700; border-radius: 10px; margin-top: 5px; }
#boss-hp-bar { width: 100%; height: 100%; background: #D32F2F; transition: width 0.1s linear; }

/* === TELA DE BAÚ === */
#chest-title { font-size: 32px; margin-bottom: 20px; font-weight: 900; text-transform: uppercase; }
#chest-content { text-align: center; font-size: 16px; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; width: 80%; }

/* Cores de Raridade */
.rarity-common { color: #FFF; }
.rarity-uncommon { color: #4CAF50; text-shadow: 0 0 5px rgba(76,175,80,0.4); }
.rarity-rare { color: #2196F3; text-shadow: 0 0 5px rgba(33,150,243,0.4); }
.rarity-epic { color: #9C27B0; text-shadow: 0 0 8px rgba(156,39,176,0.6); }
.rarity-legendary { color: #FF3D00; text-shadow: 0 0 10px #FF3D00, 0 0 20px #FFD700; font-weight: 900; border-bottom: 2px solid #FFD700; }

.chest-tier-bronze { color: #CD7F32 !important; text-shadow: 0 0 10px #CD7F32; }
.chest-tier-silver { color: #C0C0C0 !important; text-shadow: 0 0 10px #C0C0C0; }
.chest-tier-gold { color: #FFD700 !important; text-shadow: 0 0 15px #FFD700; }

/* === ENTIDADES === */
.player {
    position: absolute; background: #4CAF50; border-radius: 50%;
    box-shadow: 0 0 15px #4CAF50; z-index: 10; border: 2px solid #FFF;
    transition: background-color 0.1s; display: flex; justify-content: center;
}
.player.damaged { background-color: #F44336 !important; border-color: #B71C1C !important; box-shadow: 0 0 20px #F00 !important; }
.player.shielded { border: 3px solid #00FFFF !important; box-shadow: 0 0 20px #00FFFF, inset 0 0 10px #00FFFF !important; }

.mini-hp-container {
    position: absolute; bottom: -8px; width: 30px; height: 4px;
    background: #000; border: 1px solid #444; pointer-events: none;
}
.mini-hp-fill { height: 100%; background: #F44336; width: 100%; }

.enemy { position: absolute; z-index: 5; display: flex; justify-content: center; align-items: center; }
.enemy.frozen { filter: hue-rotate(180deg) saturate(3) brightness(1.5); }
.enemy.burning { filter: sepia(1) saturate(5) hue-rotate(-50deg); animation: burnShake 0.2s infinite; }
@keyframes burnShake { 0% { transform: translateX(1px); } 100% { transform: translateX(-1px); } }
.enemy-square { background: #D32F2F; border-radius: 3px; }
.enemy-triangle { width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 20px solid #FF9800; }
.enemy-boss { background: #880E4F; border: 4px solid #FFD700; box-shadow: 0 0 30px #880E4F; z-index: 8; }
.enemy-chest-carrier { box-shadow: 0 0 15px #FFD700, inset 0 0 10px #FFD700; border: 2px solid #FFF; }

/* Itens */
.xp-orb { position: absolute; background: #FFC107; border-radius: 50%; z-index: 2; box-shadow: 0 0 5px #FFC107; }
.chest { position: absolute; width: 24px; height: 24px; background: linear-gradient(135deg, #8B4513, #CD853F); border: 2px solid #FFD700; z-index: 3; animation: bounce 1s infinite; }
@keyframes bounce { 50% { transform: scale(1.2); } }

/* === EFEITOS === */
.ice-aura { position: absolute; border-radius: 50%; background: rgba(0, 255, 255, 0.15); border: 2px solid rgba(0, 255, 255, 0.4); pointer-events: none; z-index: 2; }
.ice-shard { position: absolute; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 15px solid #00FFFF; z-index: 20; filter: drop-shadow(0 0 5px cyan); }
.fire-zone { position: absolute; border-radius: 50%; background: radial-gradient(circle, rgba(255,87,34,0.8), rgba(255,0,0,0.2)); border: 1px solid rgba(255,87,34,0.5); z-index: 1; animation: pulseFire 1s infinite alternate; }
@keyframes pulseFire { to { transform: scale(1.1); opacity: 0.8; } }
.molotov { position: absolute; width: 10px; height: 10px; background: #FF5722; border-radius: 50%; border: 2px solid #FFF; z-index: 20; animation: spin 0.4s linear infinite; }
.fireball { position: absolute; width: 20px; height: 20px; background: #FF3D00; border-radius: 50%; border: 2px solid #FFD700; z-index: 25; box-shadow: 0 0 15px #FF5722; }
.meteor-warning { position: absolute; border-radius: 50%; background: rgba(255,0,0,0.3); border: 2px dashed #FF0000; z-index: 1; }
.static-field { position: absolute; border-radius: 50%; background: repeating-linear-gradient(45deg, rgba(224, 64, 251, 0.1), rgba(224, 64, 251, 0.1) 10px, rgba(224, 64, 251, 0.2) 10px, rgba(224, 64, 251, 0.2) 20px); border: 1px solid #E040FB; pointer-events: none; z-index: 1; }

@keyframes spin { to { transform: rotate(360deg); } }
.explosion { position: absolute; border-radius: 50%; background: radial-gradient(circle, #FFEB3B 0%, #FF5722 50%, transparent 70%); z-index: 30; animation: explode 0.5s forwards; pointer-events: none; }
@keyframes explode { 0% { transform: scale(0.2); opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }
.thunder-line { position: absolute; height: 2px; background: #FFF; box-shadow: 0 0 8px #00BFFF; transform-origin: 0 50%; pointer-events: none; z-index: 20; }
.storm-cloud { position: absolute; width: 60px; height: 60px; background: radial-gradient(circle, rgba(60,60,60,0.9), transparent); border-radius: 50%; z-index: 15; animation: stormSpin 3s linear infinite; border: 2px dashed #00BFFF; box-shadow: 0 0 10px #00BFFF; }
@keyframes stormSpin { to { transform: rotate(360deg); } }
.floating-damage { position: absolute; color: #fff; font-weight: bold; font-size: 12px; text-shadow: 1px 1px 0 #000; pointer-events: none; animation: floatUp 0.6s forwards; z-index: 999; width: 60px; margin-left: -30px; text-align: center; }
@keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-25px); opacity: 0; } }
.pause-stat-item { display: flex; justify-content: space-between; border-bottom: 1px solid #444; padding: 5px 0; font-size: 14px; }

/* === NOVO: HUD DE HABILIDADES === */
#skill-hud {
    position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 10px; z-index: 100; pointer-events: none;
}
.skill-icon {
    width: 50px; height: 50px; background: #333; border: 2px solid #555;
    border-radius: 8px; position: relative; overflow: hidden;
    display: flex; align-items: center; justify-content: center;
    font-size: 24px; color: #FFF; text-shadow: 0 0 5px #000;
}
.skill-icon.ready { border-color: #00FF00; box-shadow: 0 0 10px #00FF00; }
.skill-cd-overlay {
    position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.7);
    height: 0%; transition: height 0.1s linear;
}
.skill-count {
    position: absolute; bottom: 2px; right: 4px; font-size: 12px; font-weight: bold; color: #FFF; z-index: 2;
}

/* === CORREÇÃO: Efeito Burning (Sem quebrar rotação) === */
.enemy.burning {
    /* Removemos o transform/shake daqui para não resetar a rotação dos triângulos */
    animation: burnPulse 0.5s infinite alternate;
}
@keyframes burnPulse {
    0% { filter: sepia(1) saturate(5) hue-rotate(-50deg) brightness(1); }
    100% { filter: sepia(1) saturate(5) hue-rotate(-50deg) brightness(1.5); }
}

/* === CORREÇÃO: Efeito Para-Raio (Mais visível) === */
.thunder-line { position: absolute; height: 2px; background: #FFF; box-shadow: 0 0 8px #00BFFF; transform-origin: 0 50%; pointer-events: none; z-index: 20; }

/* Raio Grosso (Para-Raio) */
.thunder-line.thick {
    height: 6px; /* Mais grosso */
    background: #E040FB; /* Cor mais roxa/intensa */
    box-shadow: 0 0 15px #E040FB, 0 0 25px #FFF; /* Brilho forte */
    z-index: 25;
}

/* Ajuste visual para filhote de triângulo */
.enemy-triangle-child {
    border-bottom-color: #FFE082 !important; /* Amarelo mais claro */
}